// user Agent
var ua = navigator.userAgent;
if ((ua.indexOf('iPhone') > 0) || ua.indexOf('iPod') > 0 || (ua.indexOf('Android') > 0 && ua.indexOf('Mobile') > 0)) {
  $('head').prepend('<meta name="viewport" content="width=device-width, initial-scale=1.0" />');
}else{
  $('head').prepend('<meta name="viewport" content="width=990" />');
}

$(function() {
    $('#naviGlobal ul').droppy();
});

$(function() {
	$("#font-change").hide();
    $("#sizeL, #sizeM, #sizeS").show();
	var tagAnchorL = $("#sizeL a");
	var tagAnchorM = $("#sizeM a");
	var tagAnchorS = $("#sizeS a");
	var fontCookie = $.cookie('cookie_font');
	fontChange();
	
	tagAnchorL.click(function(){
		fontCookie = "sizeL";
		fontChange();
	});
	tagAnchorM.click(function(){
		fontCookie = "sizeM";
		fontChange();
	});
	tagAnchorS.click(function(){
		fontCookie = "sizeS";
		fontChange();
	});	
	function fontChange(){
		var tagLinkCss = $("#fontSize");
		$.cookie('cookie_font', fontCookie, { path: '/', expires: 365 });
		$("#headerSize li a").removeClass("active");
		switch(fontCookie){
			case "sizeL":
				tagLinkCss.attr("href","/common/css/font_l.css");
				tagAnchorL.addClass("active");
				break;
			case "sizeM":
				tagLinkCss.attr("href","/common/css/font_m.css");
				tagAnchorM.addClass("active");
				break;
			case "sizeS":
				tagLinkCss.attr("href","/common/css/font_s.css");
				tagAnchorS.addClass("active");
				break;
			default:
				tagLinkCss.attr("href","/common/css/font_m.css");
				tagAnchorM.addClass("active");
				break;
		}
		return false;
	}

	$('#anchorTop').click(function () {
	  $('body,html').animate({
		  scrollTop: 0
	  }, 500);
	  return false;
	});
});

$(function($){
 
    //変数の定義
    var body = $('body'),
        header = $('#header'),
        wrapper = $('#wrap'),
        menu = $('.slideMenu'),
        menuBtn = $('.btnMenu'),
        closeBtn = $('.btnClose'), //メニューを閉じるボタン
        menuWidth = menu.outerWidth();
 
    //メニューを開く関数
    function showMenu (event) {
        event.preventDefault(); 
 
        //bodyが動かないようにする
        currentScroll = $(window).scrollTop();
        body.css({
            position: 'fixed',
            width: '100%',
            top: -1 * currentScroll
        });
 
        //シェードを追加
        var shade = $('<div></div>');
        shade.attr('class', 'shade').on('click', hideMenu);
 
        //アニメーションを実行
        menu.before(shade).animate({
            'right' : 0
        }, 300);
        wrapper.animate({
            'right' : menuWidth
        }, 300);
        header.animate({
            'right' : menuWidth
        }, 300);
 
        //ロゴのフェードイン
        $('.slideMenu .headerClass, .slideMenu .btnBox').delay(500).animate({
			'opacity' : 1
		}, 300);
    }
 
    //メニューを閉じる関数
    function hideMenu (event) {
        event.preventDefault();
 
        //bodyに追加したstyleを削除
        body.attr('style', '');
 
        //scroll位置を調整
        $('html, body').prop({scrollTop: currentScroll});
 
        //アニメーションを実行
        menu.prop({scrollTop: 0}).animate({
            'right' : -menuWidth
        }, 300);
        wrapper.animate({
            'right' : 0
        }, 300);
        header.animate({
            'right' : 0
        }, 300);
 
        //シェードを削除
        $('.shade').remove();
 
        //ロゴのフェードアウト
        $('.slideMenu .headerClass, .slideMenu .btnBox').animate({
			'opacity' : 0
		}, 200);
    }
 
    //メニュー開閉の実行
    menuBtn.on('click', showMenu);
    closeBtn.on('click', hideMenu);
 
});

// Google Analytics
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-26837079-1']);
_gaq.push(['_trackPageview']);
_gaq.push(['_trackPageview', '/nib/pdf/2018nib.pdf']);
(function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

$(function(){
    if( $('.share-btn').length>0 ){
        //<link rel="canonical" href="https://www.pressnet.or.jp/journalism/award/2020/index_1.html">
        const $url = $('link[rel="canonical"]').attr("href");
        const $enclodeUrl = encodeURI($url);
        const $fb = $('<div class="fb-share-button" data-href="'+$url+'" data-layout="button" data-size="small"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u='+$enclodeUrl+'&amp;src=sdkpreparse" class="fb-xfbml-parse-ignore">シェア</a></div>');
        const $tw = $('<div class="tweetbtn"><a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-size="small" data-lang="ja" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div>');
        $('.share-btn').append($fb);
        $('.share-btn').append($tw);
      }
});
